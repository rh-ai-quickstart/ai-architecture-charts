{{/*
Oracle 23ai Secret
Contains database credentials and connection strings
Password is auto-generated if not provided in values.yaml
*/}}
{{- if not .Values.secret.existingSecret }}
kind: Secret
apiVersion: v1
metadata:
  name: {{ include "oracle23ai.fullname" . }}
  labels:
    {{- include "oracle23ai.labels" . | nindent 4 }}
data:
  password: {{ default (randAlphaNum 16) .Values.secret.password | b64enc | quote }}
  host: {{ .Values.secret.host | b64enc | quote }}
  port: {{ .Values.secret.port | toString | b64enc | quote }}
  serviceName: {{ .Values.secret.serviceName | b64enc | quote }}
  sid: {{ .Values.secret.sid | b64enc | quote }}
  jdbc-uri: {{ printf "jdbc:oracle:thin:@%s.%s:%s/%s" .Values.secret.host .Release.Namespace (.Values.secret.port | toString) .Values.secret.serviceName | b64enc | quote }}
  tns-uri: {{ printf "%s.%s:%s/%s" .Values.secret.host .Release.Namespace (.Values.secret.port | toString) .Values.secret.serviceName | b64enc | quote }}
type: Opaque
{{- end }}