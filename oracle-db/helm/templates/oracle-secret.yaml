{{/*
Oracle 23ai Secret
Contains database credentials and connection strings
Password is auto-generated if not provided in values.yaml
*/}}
{{- if not .Values.oracle.secret.existingSecret }}
kind: Secret
apiVersion: v1
metadata:
  name: {{ include "oracle-db.fullname" . }}
  labels:
    {{- include "oracle-db.labels" . | nindent 4 }}
    app.kubernetes.io/component: database
data:
  password: {{ include "oracle-db.oraclePassword" . | b64enc | quote }}
  host: {{ .Values.oracle.secret.host | b64enc | quote }}
  port: {{ .Values.oracle.secret.port | toString | b64enc | quote }}
  serviceName: {{ .Values.oracle.secret.serviceName | b64enc | quote }}
  sid: {{ .Values.oracle.secret.sid | b64enc | quote }}
  jdbc-uri: {{ printf "jdbc:oracle:thin:@%s.%s:%s/%s" .Values.oracle.secret.host .Release.Namespace (.Values.oracle.secret.port | toString) .Values.oracle.secret.serviceName | b64enc | quote }}
  tns-uri: {{ printf "%s.%s:%s/%s" .Values.oracle.secret.host .Release.Namespace (.Values.oracle.secret.port | toString) .Values.oracle.secret.serviceName | b64enc | quote }}
type: Opaque
{{- end }}